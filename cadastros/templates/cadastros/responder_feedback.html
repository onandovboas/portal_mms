{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pesquisa de Satisfa√ß√£o MMS</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Work+Sans:wght@400;500&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Work Sans', sans-serif; background-color: #f0f2f5; color: #343a40; }
        h1, h2, h3, h4, h5 { font-family: 'Poppins', sans-serif; }

        .main-container { max-width: 720px; margin: 0 auto; padding-bottom: 50px; }
        .card-feedback { background-color: #fff; border: 1px solid #e0e0e0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); margin-bottom: 20px; padding: 24px; position: relative; }

        .border-top-teacher { border-top: 5px solid #ffc107; }
        .border-top-admin { border-top: 5px solid #0dcaf0; }
        .border-top-pedag { border-top: 5px solid #dc3545; }
        .border-top-persona { border-top: 5px solid #6610f2; }

        /* FOTOS */
        .section-header { display: flex; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #f0f0f0; }
        .avatar-box {
            width: 150px; height: 150px;
            border-radius: 50%;
            overflow: hidden;
            border: 2px solid #dee2e6;
            margin-right: 15px;
            background: #fff;
            flex-shrink: 0;
            display: flex; justify-content: center; align-items: center;
        }
        .avatar-img {
            width: 100%; height: 100%;
            object-fit: cover;
            object-position: center;
            aspect-ratio: 1/1;
        }
        .avatar-initials { font-size: 1.2rem; font-weight: bold; color: #6c757d; }

        /* Escalas */
        .question-title { font-weight: 600; font-size: 1rem; margin-bottom: 15px; margin-top: 10px; color: #202124; }
        .scale-wrapper { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 0 5px; }
        .scale-option { display: flex; flex-direction: column; align-items: center; cursor: pointer; width: 100%; }
        .scale-option input[type="radio"] { appearance: none; width: 20px; height: 20px; border: 2px solid #5f6368; border-radius: 50%; margin-bottom: 5px; transition: all 0.2s; }
        .scale-option input[type="radio"]:checked { border-color: #0d6efd; background-color: #0d6efd; box-shadow: inset 0 0 0 3px #fff; }
        .scale-labels { display: flex; justify-content: space-between; font-size: 0.8rem; color: #70757a; padding: 0 10px; margin-bottom: 20px; }
        
        .form-label { font-weight: 600; font-size: 0.9rem; color: #5f6368; letter-spacing: 0.5px; }
    </style>
</head>
<body>

    <div class="container main-container pt-4">
        <div class="card-feedback border-top-admin" style="border-top-width: 8px; border-top-color: #0d6efd;">
            <h1 class="display-6 fw-bold text-dark mb-2">Pesquisa de Satisfa√ß√£o MMS</h1>
            <p class="text-muted">Sua opini√£o constr√≥i a nossa escola. Todos os dados coletados no feedback semestral s√£o an√¥nimos e utilizados exclusivamente para melhorar nossos servi√ßos.</p>
        </div>

        <form method="post">
            {% csrf_token %}

            <div class="card-feedback">
                <h4 class="mb-4 text-primary"><i class="bi bi-person-lines-fill me-2"></i> Atualiza√ß√£o Cadastral</h4>
                <div class="mb-3">
                    <label class="form-label text-dark">E-mail (para login e recados):</label>
                    {{ form_geral.email_confirmado }}
                </div>
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-dark">WhatsApp:</label>
                        {{ form_geral.telefone_atualizado }}
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-dark">Em qual Stage voc√™ est√°?</label>
                        {{ form_geral.stage_atual_informado }}
                    </div>
                </div>
            </div>

            <div class="card-feedback border-top-persona">
                <h4 class="mb-4 text-primary"><i class="bi bi-people-fill me-2"></i> Perfil MMS</h4>
                <p class="text-muted small mb-3">Conte um pouco mais sobre voc√™. Queremos melhorar nossos conte√∫dos para voc√™. Esses dados s√£o an√¥nimos!</p>

                <div class="row g-3">
                    <div class="col-md-6"><label class="form-label">Faixa Et√°ria</label>{{ form_geral.faixa_etaria }}</div>
                    <div class="col-md-6"><label class="form-label">Escolaridade</label>{{ form_geral.escolaridade }}</div>
                    <div class="col-md-6"><label class="form-label">√Årea de Atua√ß√£o</label>{{ form_geral.area_atuacao }}</div>
                    <div class="col-md-6"><label class="form-label">Cargo Atual / Profiss√£o</label>{{ form_geral.cargo_atual }}</div>
                    <div class="col-12"><label class="form-label">Como conheceu a MMS?</label>{{ form_geral.como_conheceu }}</div>
                    <div class="col-12"><label class="form-label">Seu maior objetivo com o ingl√™s:</label>{{ form_geral.objetivo_ingles }}</div>
                </div>
            </div>

            {% if teachers %}
            <div class="mt-5 mb-3"><h4 class="text-secondary ps-2">Avalia√ß√£o dos Teachers</h4></div>
            
            {% for teacher in teachers %}
            <div class="card-feedback border-top-teacher">
                <div class="section-header">
                    <div class="avatar-box">
                        {% if teacher.foto %}<img src="{{ teacher.foto.url }}" class="avatar-img">{% else %}<div class="avatar-initials">{{ teacher.nome_completo|slice:":2"|upper }}</div>{% endif %}
                    </div>
                    <div>
                        <h4 class="m-0 fw-bold">{{ teacher.nome_completo }}</h4>
                        <span class="badge bg-warning text-dark">Teacher</span>
                    </div>
                </div>

                <p class="question-title">1. Satisfa√ß√£o geral com as aulas deste teacher:</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="teacher_{{ teacher.id }}_satisfacao" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Insatisfeito</span><span>Muito Satisfeito</span></div>

                <p class="question-title">2. O qu√£o incentivado o teacher te mant√©m durante as aulas?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="teacher_{{ teacher.id }}_incentivo" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Pouco</span><span>Muito</span></div>

                <p class="question-title">3. O qu√£o seguro/confort√°vel se sente durante as aulas?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="teacher_{{ teacher.id }}_conforto" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Inseguro</span><span>Confort√°vel</span></div>
                
                <p class="question-title">4. O quanto voc√™ observa que o teacher {{ teacher.nome_completo }} se esfor√ßa para apresentar o conte√∫do durante as aulas?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="teacher_{{ teacher.id }}_esforco" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Pouco</span><span>Muito</span></div>
                
                <hr class="text-muted my-4">
                
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-success small">Que bom üëç (Deixe seu elogio)</label>
                        <textarea name="teacher_{{ teacher.id }}_elogio" class="form-control" rows="2"></textarea>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-danger small">Que pena üí° (Deixe sua sugest√£o de melhoria)</label>
                        <textarea name="teacher_{{ teacher.id }}_sugestao" class="form-control" rows="2"></textarea>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}

            {% if equipe_adm %}
            <div class="mt-5 mb-3"><h4 class="text-secondary ps-2">Recep√ß√£o e Administrativo</h4></div>
            {% for adm in equipe_adm %}
            <div class="card-feedback border-top-admin">
                <div class="section-header">
                    <div class="avatar-box">
                        {% if adm.foto %}<img src="{{ adm.foto.url }}" class="avatar-img">{% else %}<div class="avatar-initials">{{ adm.nome_completo|slice:":2"|upper }}</div>{% endif %}
                    </div>
                    <div><h4 class="m-0 fw-bold">{{ adm.nome_completo }}</h4><span class="badge bg-info text-white">Equipe Adm</span></div>
                </div>

                <p class="question-title">Qu√£o educado e prestativo foi o atendimento quando voc√™ precisou?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="adm_{{ adm.id }}_educacao" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Ruim</span><span>Excelente</span></div>

                <p class="question-title">Com base em suas √∫ltimas experi√™ncias, como voc√™ avalia o atendimento?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="adm_{{ adm.id }}_geral" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Ruim</span><span>Excelente</span></div>

                <p class="question-title">Qual seu n√≠vel de satisfa√ß√£o com o atendimento?</p>
                <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="adm_{{ adm.id }}_satisfacao" value="{{ i }}"></div>{% endfor %}</div>
                <div class="scale-labels"><span>Insatisfeito</span><span>Satisfeito</span></div>

                <div class="mt-4 p-3 bg-light rounded">
                    <label class="form-label mb-2 text-muted">Selecione os itens que se destacam:</label>
                    <div class="d-flex flex-wrap gap-2">
                        <input type="checkbox" class="btn-check" id="rk_{{adm.id}}_1" name="adm_{{adm.id}}_destaques" value="Rapidez"><label class="btn btn-outline-secondary btn-sm rounded-pill" for="rk_{{adm.id}}_1">Rapidez no atendimento</label>
                        <input type="checkbox" class="btn-check" id="rk_{{adm.id}}_2" name="adm_{{adm.id}}_destaques" value="Paci√™ncia"><label class="btn btn-outline-secondary btn-sm rounded-pill" for="rk_{{adm.id}}_2">Paci√™ncia</label>
                        <input type="checkbox" class="btn-check" id="rk_{{adm.id}}_3" name="adm_{{adm.id}}_destaques" value="Humor"><label class="btn btn-outline-secondary btn-sm rounded-pill" for="rk_{{adm.id}}_3">Bom Humor</label>
                        <input type="checkbox" class="btn-check" id="rk_{{adm.id}}_4" name="adm_{{adm.id}}_destaques" value="Clareza"><label class="btn btn-outline-secondary btn-sm rounded-pill" for="rk_{{adm.id}}_4">Clareza da informa√ß√£o</label>
                        <input type="checkbox" class="btn-check" id="rk_{{adm.id}}_5" name="adm_{{adm.id}}_destaques" value="Tom de Voz"><label class="btn btn-outline-secondary btn-sm rounded-pill" for="rk_{{adm.id}}_5">Tom de voz</label>
                    </div>
                </div>

                <hr class="text-muted my-4">
                <div class="row">
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-success small">Deixe seu elogio üëç</label>
                        <textarea name="adm_{{ adm.id }}_elogio" class="form-control" rows="2"></textarea>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label text-danger small">Deixe sua sugest√£o de melhoria üí°</label>
                        <textarea name="adm_{{ adm.id }}_sugestao" class="form-control" rows="2"></textarea>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}

            {% if equipe_pedagogica %}
            <div class="mt-5 mb-3"><h4 class="text-secondary ps-2">Coordena√ß√£o Pedag√≥gica</h4></div>
            {% for ped in equipe_pedagogica %}
            <div class="card-feedback border-top-pedag">
                <div class="section-header">
                    <div class="avatar-box">
                        {% if ped.foto %}<img src="{{ ped.foto.url }}" class="avatar-img">{% else %}<div class="avatar-initials">{{ ped.nome_completo|slice:":2"|upper }}</div>{% endif %}
                    </div>
                    <div><h4 class="m-0 fw-bold">{{ ped.nome_completo }}</h4><span class="badge bg-danger text-white">Pedag√≥gico</span></div>
                </div>

                <div class="form-check form-switch p-3 bg-light rounded mb-3">
                    <input class="form-check-input" type="checkbox" id="ped_{{ped.id}}_participou" name="ped_{{ped.id}}_participou" value="sim" onchange="document.getElementById('bloco_ped_{{ped.id}}').style.display = this.checked ? 'block' : 'none'">
                    <label class="form-check-label fw-bold ms-2" for="ped_{{ped.id}}_participou">Sim, participei de um Acompanhamento Pedag√≥gico com ela</label>
                </div>

                <div id="bloco_ped_{{ped.id}}" style="display:none;">
                    <p class="question-title">Qu√£o satisfeito voc√™ se sentiu com o atendimento?</p>
                    <div class="scale-wrapper">{% for i in "12345" %}<div class="scale-option"><label class="small mb-1">{{ i }}</label><input type="radio" name="ped_{{ ped.id }}_satisfacao" value="{{ i }}"></div>{% endfor %}</div>
                    <div class="scale-labels"><span>Insatisfeito</span><span>Satisfeito</span></div>
                    
                    <div class="mt-3">
                        <label class="form-label small">Quais atividades voc√™ acha que seriam interessantes para acontecer no acompanhamento pedag√≥gico?</label>
                        <textarea name="ped_{{ ped.id }}_atividades" class="form-control" rows="2"></textarea>
                    </div>

                    <hr class="text-muted my-4">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-success small">Deixe seu elogio üëç</label>
                            <textarea name="ped_{{ ped.id }}_elogio" class="form-control" rows="2"></textarea>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-danger small">Deixe sua sugest√£o de melhoria üí°</label>
                            <textarea name="ped_{{ ped.id }}_sugestao" class="form-control" rows="2"></textarea>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% endif %}

            <div class="card-feedback bg-light border-0 mt-5">
                <p class="question-title text-center" style="font-size: 1.2rem;">De 0 a 10, quanto voc√™ recomendaria nosso trabalho para um amigo ou familiar?</p>
                <div style="display: flex; justify-content: space-between; overflow-x: auto; margin-top: 20px;">
                    {% for i in "0123456789"|make_list %}
                    <div style="text-align: center; min-width: 30px;">
                        <label style="display:block; margin-bottom: 5px; font-weight: bold;">{{ i }}</label>
                        <input type="radio" name="nps_score" value="{{ i }}" style="width: 20px; height: 20px;" required>
                    </div>
                    {% endfor %}
                     <div style="text-align: center; min-width: 30px;">
                        <label style="display:block; margin-bottom: 5px; font-weight: bold;">10</label>
                        <input type="radio" name="nps_score" value="10" style="width: 20px; height: 20px;">
                    </div>
                </div>
                <div class="d-flex justify-content-between mt-2 small text-muted">
                    <span>Insatisfeito(a)</span>
                    <span>Muito satisfeito(a)</span>
                </div>

                <hr class="my-4">

                <div class="row align-items-start">
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Voc√™ nos segue no Instagram? @mmsinstitute</label>
                        <div class="form-check form-switch mb-2">
                            {{ form_geral.segue_instagram }}
                            <label class="form-check-label" for="{{ form_geral.segue_instagram.id_for_label }}">Sim, eu sigo!</label>
                        </div>
                        <div class="mt-2">
                            <label class="form-label small">Que tipo de conte√∫do voc√™ gostaria de ver com mais frequ√™ncia?</label>
                            <textarea name="conteudo_desejado" class="form-control form-control-sm" rows="2"></textarea>
                        </div>
                    </div>
                    <div class="col-md-6 mb-3">
                        <label class="form-label fw-bold">Espa√ßo Livre</label>
                        <p class="small text-muted mb-1">Aqui voc√™ pode nos contar o que quiser a respeito da escola MMS Institute! Fique a vontade para escrever <3</p>
                        {{ form_geral.comentarios_gerais }}
                    </div>
                </div>

                <div class="text-center mt-4">
                    <button type="submit" class="btn btn-primary btn-lg rounded-pill px-5 shadow">
                        Enviar Pesquisa <i class="bi bi-send-fill ms-2"></i>
                    </button>
                </div>
            </div>

        </form>
    </div>

</body>
</html>